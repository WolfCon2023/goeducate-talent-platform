(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[177],{2883:(e,t,r)=>{"use strict";r.d(t,{X:()=>o,n:()=>s});var n=r(7011);class o extends Error{constructor(e){super(e.message),this.name="ApiFetchError",this.status=e.status,this.code=e.code,this.details=e.details}}async function s(e,t){var r,s,l,i,a;let c=function(){let e=n.env.NEXT_PUBLIC_API_URL;if(!e)throw Error("Missing NEXT_PUBLIC_API_URL");return e.replace(/\/+$/,"")}(),u=new Headers(null==t?void 0:t.headers);u.set("content-type","application/json"),(null==t?void 0:t.token)&&u.set("authorization","Bearer ".concat(t.token));let d=await fetch("".concat(c).concat(e),{...t,headers:u,cache:"no-store"});if(!d.ok){let e=await d.json().catch(()=>({}));throw new o({message:null!=(i=null==(r=e.error)?void 0:r.message)?i:"Request failed: ".concat(d.status),status:d.status,code:null==(s=e.error)?void 0:s.code,details:null==(l=e.error)?void 0:l.details})}if(204===d.status)return;if(!(null!=(a=d.headers.get("content-type"))?a:"").includes("application/json")){let e=await d.text();if(!e)return;return e}let h=await d.text();if(h)return JSON.parse(h)}},3210:()=>{},5979:(e,t,r)=>{"use strict";r.d(t,{QG:()=>i,_u:()=>l,bZ:()=>c,iD:()=>o,ki:()=>a});let n="goeducate_access_token";function o(){return window.localStorage.getItem(n)}function s(e){let t="=".repeat((4-e.length%4)%4);return decodeURIComponent(atob((e+t).replace(/-/g,"+").replace(/_/g,"/")).split("").map(e=>"%".concat(e.charCodeAt(0).toString(16).padStart(2,"0"))).join(""))}function l(e){if(!e)return null;let t=e.split(".");if(3!==t.length)return null;try{var r;let e=JSON.parse(s(null!=(r=t[1])?r:""));return"string"==typeof(null==e?void 0:e.role)?e.role:null}catch(e){return null}}function i(e){if(!e)return null;let t=e.split(".");if(3!==t.length)return null;try{var r;let e=JSON.parse(s(null!=(r=t[1])?r:""));return"string"==typeof(null==e?void 0:e.sub)?e.sub:null}catch(e){return null}}function a(e){window.localStorage.setItem(n,e)}function c(){window.localStorage.removeItem(n)}},6733:(e,t,r)=>{"use strict";r.d(t,{AuthNav:()=>h});var n=r(4568),o=r(9664),s=r.n(o),l=r(7541),i=r(7620),a=r(2883),c=r(5979),u=r(9948),d=r(7011);function h(){let e=(0,l.useRouter)(),t=(0,l.usePathname)(),[r,o]=(0,i.useState)(null),[h,m]=(0,i.useState)(null),[f,v]=(0,i.useState)(null),[x,b]=(0,i.useState)(0),[g,p]=(0,i.useState)(!1),[w,j]=(0,i.useState)(0);(0,i.useEffect)(()=>{let e=(0,c.iD)();o((0,c._u)(e)),m(null),v(null),j(0);let t=!1,r=null;async function n(e){var r;let n=await (0,a.n)("/notifications/unread-count",{token:e}).catch(()=>({count:0}));t||j(null!=(r=n.count)?r:0)}async function s(e){var n;null==r||r.abort(),r=new AbortController;let o=(null!=(n=d.env.NEXT_PUBLIC_API_URL)?n:"").replace(/\/+$/,"");if(o)try{let n=await fetch("".concat(o,"/notifications/stream"),{method:"GET",headers:{Accept:"text/event-stream",Authorization:"Bearer ".concat(e)},signal:r.signal});if(!n.ok||!n.body)return;let s=n.body.getReader(),l=new TextDecoder,i="";for(;;){let e,{done:r,value:n}=await s.read();if(r)break;for(i+=l.decode(n,{stream:!0});(e=i.indexOf("\n\n"))>=0;){let r=i.slice(0,e);i=i.slice(e+2);let n=r.split("\n").map(e=>e.trimEnd()),o=n.find(e=>e.startsWith("event:")),s=n.find(e=>e.startsWith("data:")),l=o?o.slice(6).trim():"",a=s?s.slice(5).trim():"";if("unread"===l&&a)try{let e=JSON.parse(a);t||"number"!=typeof e.count||j(e.count)}catch(e){}}}}catch(e){}}async function l(){if(e)try{var t;let r=await (0,a.n)("/auth/me",{token:e});o(r.user.role),m(r.user.displayName),v(null!=(t=r.user.profilePhotoUrl)?t:null),b(Date.now()),await n(e),s(e)}catch(e){(0,c.bZ)(),o(null),m(null),j(0)}}l();let i=()=>{e&&n(e)};window.addEventListener("goeducate:notifications-changed",i);let u=()=>{l()};return window.addEventListener("goeducate:me-changed",u),()=>{t=!0,null==r||r.abort(),window.removeEventListener("goeducate:notifications-changed",i),window.removeEventListener("goeducate:me-changed",u)}},[t]);let y=(0,i.useMemo)(()=>"player"===r?"/player":"coach"===r?"/coach":"evaluator"===r?"/evaluator":"admin"===r?"/admin":"/",[r]),N=(0,i.useMemo)(()=>{var e;return(null!=(e=d.env.NEXT_PUBLIC_API_URL)?e:"").replace(/\/+$/,"")},[]),k=f?"".concat(N).concat(f,"?v=").concat(x):null;function C(e){let r=t===e||"/"!==e&&(null==t?void 0:t.startsWith(e));return"rounded-md px-2.5 py-1.5 text-sm ".concat(r?"bg-[var(--surface-soft)] text-[color:var(--foreground)]":"text-[color:var(--muted)] hover:bg-[var(--surface-soft)]")}return(0,n.jsx)("nav",{className:"flex items-center gap-2 text-sm",children:r?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(s(),{href:"/player",className:C("/player"),children:"Player"}),(0,n.jsx)(s(),{href:"/coach",className:C("/coach"),children:"Coach"}),(0,n.jsx)(s(),{href:"/showcases",className:C("/showcases"),children:"Showcases"}),(0,n.jsx)(s(),{href:"/showcases/registrations",className:C("/showcases/registrations"),children:"My registrations"}),f?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("button",{type:"button",onClick:()=>p(!0),className:"rounded-full focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-white/60","aria-label":"View profile photo",title:"Click to enlarge",children:(0,n.jsx)("img",{src:null!=k?k:"".concat(N).concat(f),alt:"Profile photo",className:"h-8 w-8 rounded-full border border-white/10 object-cover"})}),g?(0,n.jsx)(u.B,{src:null!=k?k:"".concat(N).concat(f),alt:"Profile photo",onClose:()=>p(!1)}):null]}):null,(0,n.jsx)(s(),{href:y,className:C(y),children:"Dashboard"}),"coach"===r?(0,n.jsx)(s(),{href:"/coach/billing",className:C("/coach/billing"),children:"Billing"}):null,(0,n.jsx)(s(),{href:"/notifications",className:C("/notifications"),children:(0,n.jsxs)("span",{className:"inline-flex items-center gap-2",children:[(0,n.jsx)("span",{children:"Notifications"}),w>0?(0,n.jsx)("span",{className:"rounded-full bg-indigo-600 px-2 py-0.5 text-xs font-semibold text-white",children:w>99?"99+":w}):null]})}),(0,n.jsxs)("span",{className:"rounded-full border border-[color:var(--border)] bg-[var(--surface-soft)] px-2.5 py-1 text-xs font-semibold text-[color:var(--muted-2)]",children:[r,h?" \xb7 ".concat(h):""]}),(0,n.jsx)("button",{type:"button",onClick:function(){(0,c.bZ)(),o(null),e.push("/"),e.refresh()},className:"rounded-md border border-[color:var(--border)] bg-[var(--surface-soft)] px-3 py-1.5 text-sm text-[color:var(--foreground)] hover:bg-[var(--surface)] focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-white/60",children:"Logout"})]}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(s(),{href:"/login",className:C("/login"),children:"Login"}),(0,n.jsx)(s(),{href:"/request-access",className:"rounded-md bg-indigo-600 px-3 py-1.5 text-sm font-medium text-white hover:bg-indigo-500",children:"Request access"})]})})}},6848:(e,t,r)=>{"use strict";r.d(t,{D:()=>a,ThemeProvider:()=>i});var n=r(4568),o=r(7620);let s=(0,o.createContext)(void 0),l="goeducate_theme";function i(e){let[t,r]=(0,o.useState)("dark");(0,o.useEffect)(()=>{let e=window.localStorage.getItem(l);if("light"===e||"dark"===e){r(e),document.documentElement.setAttribute("data-theme",e);return}document.documentElement.setAttribute("data-theme","dark"),r("dark")},[]),(0,o.useEffect)(()=>{document.documentElement.setAttribute("data-theme",t),window.localStorage.setItem(l,t)},[t]);let i=(0,o.useMemo)(()=>({theme:t,setTheme:function(e){r(e)},toggleTheme:function(){r(e=>"dark"===e?"light":"dark")}}),[t]);return(0,n.jsx)(s.Provider,{value:i,children:e.children})}function a(){let e=(0,o.useContext)(s);if(!e)throw Error("useTheme must be used within ThemeProvider");return e}},7451:(e,t,r)=>{"use strict";r.d(t,{ThemeToggle:()=>s});var n=r(4568),o=r(6848);function s(){let{theme:e,toggleTheme:t}=(0,o.D)(),r="dark"===e;return(0,n.jsxs)("button",{type:"button",onClick:t,"aria-label":r?"Switch to light mode":"Switch to dark mode",className:"inline-flex items-center gap-2 rounded-lg border border-[color:var(--color-border)] bg-[color:var(--color-panel)] px-3 py-1.5 text-xs text-[color:var(--color-text-muted)] hover:bg-[color:var(--color-muted)] hover:text-[color:var(--color-text)] transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-[color:var(--color-primary-600)]",children:[r?(0,n.jsxs)("svg",{viewBox:"0 0 24 24",className:"h-4 w-4",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[(0,n.jsx)("path",{d:"M12 18a6 6 0 1 0 0-12 6 6 0 0 0 0 12Z"}),(0,n.jsx)("path",{d:"M12 2v2"}),(0,n.jsx)("path",{d:"M12 20v2"}),(0,n.jsx)("path",{d:"M4.93 4.93l1.41 1.41"}),(0,n.jsx)("path",{d:"M17.66 17.66l1.41 1.41"}),(0,n.jsx)("path",{d:"M2 12h2"}),(0,n.jsx)("path",{d:"M20 12h2"}),(0,n.jsx)("path",{d:"M4.93 19.07l1.41-1.41"}),(0,n.jsx)("path",{d:"M17.66 6.34l1.41-1.41"})]}):(0,n.jsx)("svg",{viewBox:"0 0 24 24",className:"h-4 w-4",fill:"none",stroke:"currentColor",strokeWidth:"2",children:(0,n.jsx)("path",{d:"M21 12.8A8.5 8.5 0 0 1 11.2 3a6.5 6.5 0 1 0 9.8 9.8Z"})}),(0,n.jsxs)("span",{className:"hidden sm:inline",children:[r?"Light":"Dark"," mode"]})]})}},7541:(e,t,r)=>{"use strict";var n=r(3041);r.o(n,"useParams")&&r.d(t,{useParams:function(){return n.useParams}}),r.o(n,"usePathname")&&r.d(t,{usePathname:function(){return n.usePathname}}),r.o(n,"useRouter")&&r.d(t,{useRouter:function(){return n.useRouter}}),r.o(n,"useSearchParams")&&r.d(t,{useSearchParams:function(){return n.useSearchParams}})},8051:(e,t,r)=>{Promise.resolve().then(r.t.bind(r,3210,23)),Promise.resolve().then(r.bind(r,6733)),Promise.resolve().then(r.bind(r,8648)),Promise.resolve().then(r.bind(r,6848)),Promise.resolve().then(r.bind(r,7451)),Promise.resolve().then(r.t.bind(r,9664,23)),Promise.resolve().then(r.t.bind(r,489,23))},8648:(e,t,r)=>{"use strict";r.d(t,{ConfirmProvider:()=>l,S:()=>i});var n=r(4568),o=r(7620);let s=(0,o.createContext)(null);function l(e){let[t,r]=(0,o.useState)({open:!1,title:"Confirm",message:"",confirmText:"Confirm",cancelText:"Cancel",destructive:!1}),l=(0,o.useMemo)(()=>e=>new Promise(t=>{var n,o,s;r({open:!0,title:null!=(n=e.title)?n:"Confirm",message:e.message,confirmText:null!=(o=e.confirmText)?o:"Confirm",cancelText:null!=(s=e.cancelText)?s:"Cancel",destructive:!!e.destructive,resolve:t})}),[]);function i(e){let n=t.resolve;r(e=>({...e,open:!1,resolve:void 0})),null==n||n(e)}return(0,n.jsxs)(s.Provider,{value:l,children:[e.children,t.open?(0,n.jsxs)("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:[(0,n.jsx)("div",{className:"absolute inset-0 bg-black/70",onClick:()=>i(!1)}),(0,n.jsxs)("div",{className:"relative w-full max-w-lg rounded-2xl border border-[color:var(--border)] bg-[var(--surface)] p-6 shadow-2xl",children:[(0,n.jsx)("div",{className:"text-lg font-semibold text-[color:var(--foreground)]",children:t.title}),(0,n.jsx)("p",{className:"mt-2 whitespace-pre-wrap text-sm text-[color:var(--muted)]",children:t.message}),(0,n.jsxs)("div",{className:"mt-6 flex flex-wrap justify-end gap-3",children:[(0,n.jsx)("button",{type:"button",className:"rounded-md border border-[color:var(--border)] bg-[var(--surface-soft)] px-4 py-2 text-sm font-medium text-[color:var(--foreground)] hover:bg-[var(--surface)] focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-white/60",onClick:()=>i(!1),children:t.cancelText}),(0,n.jsx)("button",{type:"button",className:"rounded-md px-4 py-2 text-sm font-medium ".concat(t.destructive?"bg-red-500 text-white hover:bg-red-600 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-white/60":"bg-indigo-600 text-white hover:bg-indigo-500 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-white/60"),onClick:()=>i(!0),children:t.confirmText})]})]})]}):null]})}function i(){let e=(0,o.useContext)(s);if(!e)throw Error("useConfirm must be used within ConfirmProvider");return e}},9948:(e,t,r)=>{"use strict";r.d(t,{B:()=>l});var n=r(4568),o=r(7620),s=r(7509);function l(e){var t;let[r,l]=(0,o.useState)(!1);return((0,o.useEffect)(()=>{l(!0)},[]),(0,o.useEffect)(()=>{function t(t){"Escape"===t.key&&e.onClose()}return window.addEventListener("keydown",t),()=>window.removeEventListener("keydown",t)},[e]),(0,o.useEffect)(()=>{let e=document.body.style.overflow;return document.body.style.overflow="hidden",()=>{document.body.style.overflow=e}},[]),r)?(0,s.createPortal)((0,n.jsx)("div",{className:"fixed inset-0 z-[100] flex items-center justify-center bg-black/80 p-4 backdrop-blur-sm",role:"dialog","aria-modal":"true",onMouseDown:t=>{t.currentTarget===t.target&&e.onClose()},children:(0,n.jsxs)("div",{className:"flex max-h-[92vh] w-full max-w-4xl flex-col",children:[(0,n.jsx)("div",{className:"mb-3 flex items-center justify-end",children:(0,n.jsx)("button",{type:"button",onClick:e.onClose,className:"rounded-md border border-white/15 bg-white/5 px-3 py-1.5 text-sm text-white hover:bg-white/10 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-white/60",children:"Close"})}),(0,n.jsx)("div",{className:"min-h-0 overflow-auto rounded-2xl border border-white/10 bg-white/5 p-2",children:(0,n.jsx)("img",{src:e.src,alt:null!=(t=e.alt)?t:"Image",className:"mx-auto max-h-[82vh] w-auto max-w-full object-contain"})})]})}),document.body):null}}},e=>{e.O(0,[857,664,489,587,18,358],()=>e(e.s=8051)),_N_E=e.O()}]);