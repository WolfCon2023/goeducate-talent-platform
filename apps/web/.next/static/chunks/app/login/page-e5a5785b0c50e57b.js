(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[520],{2883:(e,r,t)=>{"use strict";t.d(r,{X:()=>n,n:()=>l});var s=t(7011);class n extends Error{constructor(e){super(e.message),this.name="ApiFetchError",this.status=e.status,this.code=e.code,this.details=e.details}}async function l(e,r){var t,l,o,a,i;let u=function(){let e=s.env.NEXT_PUBLIC_API_URL;if(!e)throw Error("Missing NEXT_PUBLIC_API_URL");return e.replace(/\/+$/,"")}(),c=new Headers(null==r?void 0:r.headers);c.set("content-type","application/json"),(null==r?void 0:r.token)&&c.set("authorization","Bearer ".concat(r.token));let d=await fetch("".concat(u).concat(e),{...r,headers:c,cache:"no-store"});if(!d.ok){let e=await d.json().catch(()=>({}));throw new n({message:null!=(a=null==(t=e.error)?void 0:t.message)?a:"Request failed: ".concat(d.status),status:d.status,code:null==(l=e.error)?void 0:l.code,details:null==(o=e.error)?void 0:o.details})}if(204===d.status)return;if(!(null!=(i=d.headers.get("content-type"))?i:"").includes("application/json")){let e=await d.text();if(!e)return;return e}let m=await d.text();if(m)return JSON.parse(m)}},3200:(e,r,t)=>{"use strict";t.d(r,{B:()=>l,_:()=>n});var s=t(2883);function n(e){if(e instanceof s.X){let r=e.details,t=(null==r?void 0:r.fieldErrors)&&"object"==typeof r.fieldErrors?r.fieldErrors:void 0,s=Array.isArray(null==r?void 0:r.formErrors)?r.formErrors:[];return{formError:[e.message,...s].filter(Boolean).join(" ")||e.message,fieldErrors:t}}return e instanceof Error?{formError:e.message}:{formError:"Something went wrong."}}function l(e,r){var t;let s=null==e?void 0:e[r];return s&&Array.isArray(s)&&0!==s.length&&null!=(t=s[0])?t:null}},4542:(e,r,t)=>{"use strict";t.d(r,{$n:()=>n,JU:()=>o,Zp:()=>a,pd:()=>l});var s=t(4568);function n(e){let{className:r="",...t}=e;return(0,s.jsx)("button",{className:"rounded-md bg-indigo-600 px-4 py-2 text-sm font-medium text-white hover:bg-indigo-500 disabled:opacity-60 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-[color:var(--color-primary-600)] ".concat(r),...t})}function l(e){let{className:r="",...t}=e;return(0,s.jsx)("input",{className:"w-full rounded-md border border-[color:var(--border)] bg-[var(--surface-soft)] px-3 py-2 text-sm text-[color:var(--foreground)] placeholder:text-[color:var(--muted-3)] focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-[color:var(--color-primary-600)] ".concat(r),...t})}function o(e){return(0,s.jsx)("label",{htmlFor:e.htmlFor,className:"text-sm font-medium text-[color:var(--muted)]",children:e.children})}function a(e){return(0,s.jsx)("div",{className:"rounded-2xl border border-[color:var(--border)] bg-[var(--surface)] p-6",children:e.children})}},4731:(e,r,t)=>{Promise.resolve().then(t.bind(t,8765))},5979:(e,r,t)=>{"use strict";t.d(r,{QG:()=>a,_u:()=>o,bZ:()=>u,iD:()=>n,ki:()=>i});let s="goeducate_access_token";function n(){return window.localStorage.getItem(s)}function l(e){let r="=".repeat((4-e.length%4)%4);return decodeURIComponent(atob((e+r).replace(/-/g,"+").replace(/_/g,"/")).split("").map(e=>"%".concat(e.charCodeAt(0).toString(16).padStart(2,"0"))).join(""))}function o(e){if(!e)return null;let r=e.split(".");if(3!==r.length)return null;try{var t;let e=JSON.parse(l(null!=(t=r[1])?t:""));return"string"==typeof(null==e?void 0:e.role)?e.role:null}catch(e){return null}}function a(e){if(!e)return null;let r=e.split(".");if(3!==r.length)return null;try{var t;let e=JSON.parse(l(null!=(t=r[1])?t:""));return"string"==typeof(null==e?void 0:e.sub)?e.sub:null}catch(e){return null}}function i(e){window.localStorage.setItem(s,e)}function u(){window.localStorage.removeItem(s)}},6015:(e,r,t)=>{"use strict";t.d(r,{N:()=>l,b:()=>o});var s=t(4568),n=t(3200);function l(e){var r,t;let n=Object.entries(null!=(r=e.fieldErrors)?r:{}).filter(e=>{let[,r]=e;return Array.isArray(r)&&r.length>0});return e.formError||n.length>0?(0,s.jsxs)("div",{className:"rounded-xl border border-red-400/30 bg-red-500/10 p-4",children:[(0,s.jsx)("div",{className:"text-sm font-semibold text-red-200",children:null!=(t=e.title)?t:"Please fix the following:"}),(0,s.jsxs)("div",{className:"mt-2 grid gap-1 text-sm text-red-100",children:[e.formError?(0,s.jsx)("div",{children:e.formError}):null,n.length?(0,s.jsx)("ul",{className:"list-disc pl-5",children:n.slice(0,8).map(e=>{let[r,t]=e;return(0,s.jsxs)("li",{children:[(0,s.jsxs)("span",{className:"font-semibold",children:[r,":"]})," ",t[0]]},r)})}):null]})]}):null}function o(e){let r=(0,n.B)(e.fieldErrors,e.name);return r?(0,s.jsx)("div",{className:"text-sm text-red-300",children:r}):null}},7541:(e,r,t)=>{"use strict";var s=t(3041);t.o(s,"useParams")&&t.d(r,{useParams:function(){return s.useParams}}),t.o(s,"usePathname")&&t.d(r,{usePathname:function(){return s.usePathname}}),t.o(s,"useRouter")&&t.d(r,{useRouter:function(){return s.useRouter}}),t.o(s,"useSearchParams")&&t.d(r,{useSearchParams:function(){return s.useSearchParams}})},8765:(e,r,t)=>{"use strict";t.r(r),t.d(r,{default:()=>f});var s=t(4568),n=t(7541),l=t(7620),o=t(4542),a=t(2883),i=t(5979),u=t(9664),c=t.n(u),d=t(6015),m=t(3200);function f(){let e=(0,n.useRouter)(),[r,t]=(0,l.useState)(""),[u,f]=(0,l.useState)(""),[h,p]=(0,l.useState)(null),[v,g]=(0,l.useState)(void 0),[x,b]=(0,l.useState)(!1);async function j(t){t.preventDefault(),p(null),g(void 0),b(!0);try{let t={};if(r.trim()||(t.email=["Email is required."]),u||(t.password=["Password is required."]),Object.keys(t).length>0)return void g(t);let s=await (0,a.n)("/auth/login",{method:"POST",body:JSON.stringify({email:r,password:u})});(0,i.ki)(s.token),"player"===s.user.role?e.push("/player"):"coach"===s.user.role?e.push("/coach"):"evaluator"===s.user.role?e.push("/evaluator"):"admin"===s.user.role?e.push("/admin"):e.push("/")}catch(r){var s;let e=(0,m._)(r);p(null!=(s=e.formError)?s:"Login failed"),g(e.fieldErrors)}finally{b(!1)}}return(0,s.jsx)("div",{className:"mx-auto max-w-md",children:(0,s.jsxs)(o.Zp,{children:[(0,s.jsx)("h1",{className:"text-xl font-semibold",children:"Login"}),(0,s.jsx)("p",{className:"mt-1 text-sm text-white/80",children:"Sign in to your account."}),(0,s.jsxs)("form",{onSubmit:j,className:"mt-6 grid gap-4",children:[(0,s.jsx)(d.N,{formError:null!=h?h:void 0,fieldErrors:v}),(0,s.jsxs)("div",{className:"grid gap-2",children:[(0,s.jsx)(o.JU,{htmlFor:"email",children:"Email"}),(0,s.jsx)(o.pd,{id:"email",value:r,onChange:e=>t(e.target.value),autoComplete:"email"}),(0,s.jsx)(d.b,{name:"email",fieldErrors:v})]}),(0,s.jsxs)("div",{className:"grid gap-2",children:[(0,s.jsx)(o.JU,{htmlFor:"password",children:"Password"}),(0,s.jsx)(o.pd,{id:"password",type:"password",value:u,onChange:e=>f(e.target.value),autoComplete:"current-password"}),(0,s.jsx)(d.b,{name:"password",fieldErrors:v})]}),(0,s.jsx)(o.$n,{type:"submit",disabled:x,children:x?"Signing in...":"Sign in"})]}),(0,s.jsxs)("div",{className:"mt-6 text-sm text-white/80",children:["Need access?"," ",(0,s.jsx)(c(),{href:"/request-access",className:"text-indigo-300 hover:text-indigo-200 hover:underline",children:"Request access"})]})]})})}}},e=>{e.O(0,[664,587,18,358],()=>e(e.s=4731)),_N_E=e.O()}]);