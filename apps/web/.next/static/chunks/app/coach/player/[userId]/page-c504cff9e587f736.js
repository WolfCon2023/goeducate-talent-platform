(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[988],{2515:(e,t,s)=>{"use strict";s.d(t,{CoachGuard:()=>a});var i=s(4568),r=s(3996);function a(e){return(0,i.jsx)(r.RoleGuard,{allowed:["coach","admin"],children:e.children})}},2883:(e,t,s)=>{"use strict";s.d(t,{X:()=>r,n:()=>a});var i=s(7011);class r extends Error{constructor(e){super(e.message),this.name="ApiFetchError",this.status=e.status,this.code=e.code,this.details=e.details}}async function a(e,t){var s,a,l,n,o;let c=function(){let e=i.env.NEXT_PUBLIC_API_URL;if(!e)throw Error("Missing NEXT_PUBLIC_API_URL");return e.replace(/\/+$/,"")}(),d=new Headers(null==t?void 0:t.headers);d.set("content-type","application/json"),(null==t?void 0:t.token)&&d.set("authorization","Bearer ".concat(t.token));let u=await fetch("".concat(c).concat(e),{...t,headers:d,cache:"no-store"});if(!u.ok){let e=await u.json().catch(()=>({}));throw new r({message:null!=(n=null==(s=e.error)?void 0:s.message)?n:"Request failed: ".concat(u.status),status:u.status,code:null==(a=e.error)?void 0:a.code,details:null==(l=e.error)?void 0:l.details})}if(204===u.status)return;if(!(null!=(o=u.headers.get("content-type"))?o:"").includes("application/json")){let e=await u.text();if(!e)return;return e}let h=await u.text();if(h)return JSON.parse(h)}},3996:(e,t,s)=>{"use strict";s.d(t,{RoleGuard:()=>o});var i=s(4568),r=s(7541),a=s(7620),l=s(5979);let n={player:"/player",coach:"/coach",evaluator:"/evaluator",admin:"/admin"};function o(e){return!0!==function(e){let t=(0,r.useRouter)(),[s,i]=(0,a.useState)(null),o=e.join(",");return(0,a.useEffect)(()=>{let e=(0,l.iD)(),s=(0,l._u)(e);if(!e||!s){i(!1),t.push("/login");return}if(!new Set(o.split(",").filter(Boolean)).has(s)){var r;i(!1),t.push(null!=(r=n[s])?r:"/");return}i(!0)},[t,o]),s}(e.allowed)?null:(0,i.jsx)(i.Fragment,{children:e.children})}},4542:(e,t,s)=>{"use strict";s.d(t,{$n:()=>r,JU:()=>l,Zp:()=>n,pd:()=>a});var i=s(4568);function r(e){let{className:t="",...s}=e;return(0,i.jsx)("button",{className:"rounded-md bg-indigo-600 px-4 py-2 text-sm font-medium text-white hover:bg-indigo-500 disabled:opacity-60 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-[color:var(--color-primary-600)] ".concat(t),...s})}function a(e){let{className:t="",...s}=e;return(0,i.jsx)("input",{className:"w-full rounded-md border border-[color:var(--border)] bg-[var(--surface-soft)] px-3 py-2 text-sm text-[color:var(--foreground)] placeholder:text-[color:var(--muted-3)] focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-[color:var(--color-primary-600)] ".concat(t),...s})}function l(e){return(0,i.jsx)("label",{htmlFor:e.htmlFor,className:"text-sm font-medium text-[color:var(--muted)]",children:e.children})}function n(e){return(0,i.jsx)("div",{className:"rounded-2xl border border-[color:var(--border)] bg-[var(--surface)] p-6",children:e.children})}},5979:(e,t,s)=>{"use strict";s.d(t,{QG:()=>n,_u:()=>l,bZ:()=>c,iD:()=>r,ki:()=>o});let i="goeducate_access_token";function r(){return window.localStorage.getItem(i)}function a(e){let t="=".repeat((4-e.length%4)%4);return decodeURIComponent(atob((e+t).replace(/-/g,"+").replace(/_/g,"/")).split("").map(e=>"%".concat(e.charCodeAt(0).toString(16).padStart(2,"0"))).join(""))}function l(e){if(!e)return null;let t=e.split(".");if(3!==t.length)return null;try{var s;let e=JSON.parse(a(null!=(s=t[1])?s:""));return"string"==typeof(null==e?void 0:e.role)?e.role:null}catch(e){return null}}function n(e){if(!e)return null;let t=e.split(".");if(3!==t.length)return null;try{var s;let e=JSON.parse(a(null!=(s=t[1])?s:""));return"string"==typeof(null==e?void 0:e.sub)?e.sub:null}catch(e){return null}}function o(e){window.localStorage.setItem(i,e)}function c(){window.localStorage.removeItem(i)}},6305:(e,t,s)=>{Promise.resolve().then(s.bind(s,2515)),Promise.resolve().then(s.bind(s,8642)),Promise.resolve().then(s.t.bind(s,9664,23))},7541:(e,t,s)=>{"use strict";var i=s(3041);s.o(i,"useParams")&&s.d(t,{useParams:function(){return i.useParams}}),s.o(i,"usePathname")&&s.d(t,{usePathname:function(){return i.usePathname}}),s.o(i,"useRouter")&&s.d(t,{useRouter:function(){return i.useRouter}}),s.o(i,"useSearchParams")&&s.d(t,{useSearchParams:function(){return i.useSearchParams}})},8642:(e,t,s)=>{"use strict";s.d(t,{CoachPlayerDetail:()=>d});var i=s(4568),r=s(7620),a=s(9664),l=s.n(a),n=s(4542),o=s(2883),c=s(5979);function d(e){var t,s;let[a,d]=(0,r.useState)(!1),[u,h]=(0,r.useState)(null),[m,x]=(0,r.useState)(null),[p,v]=(0,r.useState)([]),[f,g]=(0,r.useState)([]),[w,b]=(0,r.useState)(null),[j,N]=(0,r.useState)(null),[y,S]=(0,r.useState)(null);async function k(e){h(null),d(!0);try{let t=(0,c.iD)(),s=(0,c._u)(t);if(!t)throw Error("Please login as a coach first.");if("coach"!==s&&"admin"!==s&&"evaluator"!==s)throw Error("Insufficient permissions.");S(null!=s?s:null);let i=await (0,o.n)("/player-profiles/player/".concat(e),{token:t}),r=await (0,o.n)("/film-submissions/player/".concat(e),{token:t}),a=await (0,o.n)("/evaluations/player/".concat(e),{token:t});x(i),v(r.results),g(a.results),b(null),N(null)}catch(e){h(e instanceof Error?e.message:"Failed to load player")}finally{d(!1)}}async function P(){N(null);try{let t=(0,c.iD)();if(!t)throw Error("Please login as a coach first.");let s=await (0,o.n)("/contact/player/".concat(e.userId),{token:t});b(s)}catch(e){b(null),N(e instanceof Error?e.message:"Failed to load contact info")}}return(0,r.useEffect)(()=>{k(e.userId)},[e.userId]),(0,i.jsxs)("div",{className:"grid gap-6",children:[(0,i.jsxs)(n.Zp,{children:[(0,i.jsxs)("div",{className:"flex items-start justify-between gap-4",children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("h2",{className:"text-lg font-semibold",children:"Overview"}),(0,i.jsx)("p",{className:"mt-1 text-sm text-white/80",children:"Player profile, film, evaluations, and subscription-gated contact info."})]}),(0,i.jsx)(n.$n,{type:"button",onClick:()=>k(e.userId),disabled:a,children:a?"Refreshing...":"Refresh"})]}),u?(0,i.jsx)("p",{className:"mt-4 text-sm text-red-300",children:u}):null,m?(0,i.jsxs)("div",{className:"mt-6 text-sm text-white/90",children:[(0,i.jsxs)("div",{className:"text-base font-semibold",children:[m.firstName," ",m.lastName]}),(0,i.jsxs)("div",{className:"mt-1 text-white/80",children:[m.position," \xb7 ",m.gradYear," \xb7 ",m.city,", ",m.state,m.heightIn?" \xb7 ".concat(function(e){if("number"!=typeof e||!Number.isFinite(e)||e<=0)return null;let t=Math.floor(e/12);return"".concat(t,"'").concat(e%12,'"')}(m.heightIn)):"",m.weightLb?" \xb7 ".concat(m.weightLb," lb"):""]})]}):(0,i.jsx)("p",{className:"mt-4 text-sm text-white/70",children:a?"Loading...":"No profile found."})]}),(0,i.jsxs)(n.Zp,{children:[(0,i.jsx)("h2",{className:"text-lg font-semibold",children:"Film submissions"}),(0,i.jsxs)("div",{className:"mt-4 grid gap-3",children:[p.map(e=>(0,i.jsxs)("div",{className:"rounded-2xl border border-white/10 bg-white/5 p-4",children:[(0,i.jsxs)("div",{className:"flex flex-wrap items-baseline justify-between gap-2",children:[(0,i.jsx)("div",{className:"font-semibold",children:e.title}),(0,i.jsx)("div",{className:"text-xs uppercase tracking-wide ".concat("completed"===e.status?"text-emerald-300":"in_review"===e.status?"text-amber-300":"text-white/70"),children:e.status.replace("_"," ")})]}),(0,i.jsxs)("div",{className:"mt-1 text-sm text-white/80",children:[e.opponent?(0,i.jsxs)(i.Fragment,{children:["Opponent: ",e.opponent]}):null,e.opponent&&e.gameDate?" \xb7 ":null,e.gameDate?(0,i.jsxs)(i.Fragment,{children:["Game date: ",new Date(e.gameDate).toLocaleDateString()]}):null]}),e.videoUrl?(0,i.jsx)("div",{className:"mt-2 text-sm",children:(0,i.jsx)("a",{className:"text-indigo-300 hover:text-indigo-200 hover:underline",href:e.videoUrl,target:"_blank",rel:"noreferrer",children:"View video link"})}):null,e.notes?(0,i.jsx)("p",{className:"mt-2 text-sm text-white/80",children:e.notes}):null]},e._id)),0===p.length?(0,i.jsx)("p",{className:"text-sm text-white/70",children:"No film submissions yet."}):null]})]}),(0,i.jsxs)(n.Zp,{children:[(0,i.jsx)("h2",{className:"text-lg font-semibold",children:"Evaluations"}),(0,i.jsxs)("div",{className:"mt-4 grid gap-3",children:[f.map(e=>{var t,s,r,a,l;return(0,i.jsxs)("div",{className:"rounded-2xl border border-white/10 bg-white/5 p-4",children:[(0,i.jsxs)("div",{className:"flex flex-wrap items-baseline justify-between gap-2",children:[(0,i.jsxs)("div",{className:"font-semibold",children:["Grade: ",e.overallGrade,"/10"]}),(0,i.jsx)("div",{className:"text-xs text-white/60",children:e.createdAt?new Date(e.createdAt).toLocaleString():""})]}),e.sport||e.position||e.positionOther?(0,i.jsxs)("div",{className:"mt-2 text-sm text-white/80",children:[e.sport?"Sport: ".concat(e.sport):"Sport: —"," \xb7 ","Other"===e.position?"Position: ".concat(null!=(r=e.positionOther)?r:"Other"):e.position?"Position: ".concat(e.position):"Position: —"]}):null,(0,i.jsxs)("div",{className:"mt-3 grid gap-3 text-sm text-white/90",children:["number"==typeof e.overallGradeRaw?(0,i.jsxs)("div",{className:"rounded-2xl border border-white/10 bg-white/5 p-3",children:[(0,i.jsx)("div",{className:"text-xs uppercase tracking-wide text-white/70",children:"Average score"}),(0,i.jsxs)("div",{className:"mt-1 flex flex-wrap items-baseline justify-between gap-3",children:[(0,i.jsxs)("div",{className:"font-semibold text-white",children:[e.overallGradeRaw.toFixed(1),"/10"]}),(0,i.jsxs)("div",{className:"text-xs text-white/70",children:["Suggested projection: ",null!=(a=e.suggestedProjectionLabel)?a:(l=e.overallGradeRaw)>=9?"Elite Upside":l>=7.5?"High Upside":l>=6?"Solid":"Developmental"]})]}),(0,i.jsxs)("div",{className:"mt-2 relative h-2.5 w-full overflow-hidden rounded-full border border-white/10 bg-white/5",children:[(0,i.jsx)("div",{className:"absolute inset-0",style:{background:"linear-gradient(90deg, rgba(239,68,68,.85) 0%, rgba(245,158,11,.85) 35%, rgba(99,102,241,.9) 70%, rgba(16,185,129,.9) 100%)"}}),(0,i.jsx)("div",{className:"absolute top-0 h-full w-1 rounded-full bg-white",style:{left:"".concat(Math.max(0,Math.min(100,(e.overallGradeRaw-1)/9*100)),"%")},"aria-hidden":!0})]})]}):null,(null==(s=e.rubric)||null==(t=s.categories)?void 0:t.length)?(0,i.jsxs)("div",{className:"rounded-2xl border border-white/10 bg-white/5 p-3",children:[(0,i.jsx)("div",{className:"text-xs uppercase tracking-wide text-white/70",children:"Rubric"}),(0,i.jsx)("div",{className:"mt-2 grid gap-3",children:e.rubric.categories.map(e=>(0,i.jsxs)("div",{children:[(0,i.jsx)("div",{className:"text-xs font-semibold text-white/80",children:e.key}),(0,i.jsx)("div",{className:"mt-1 grid gap-1",children:e.traits.slice(0,5).map(e=>{var t;return(0,i.jsxs)("div",{className:"flex items-center justify-between gap-2 text-xs text-white/70",children:[(0,i.jsx)("div",{className:"text-white/80",children:e.key}),(0,i.jsx)("div",{children:"number"==typeof e.valueNumber?e.valueNumber:null!=(t=e.valueOption)?t:"—"})]},e.key)})})]},e.key))})]}):null,(0,i.jsxs)("div",{children:[(0,i.jsx)("div",{className:"text-xs uppercase tracking-wide text-white/70",children:"Strengths"}),(0,i.jsx)("div",{className:"mt-1 whitespace-pre-wrap",children:e.strengths})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("div",{className:"text-xs uppercase tracking-wide text-white/70",children:"Improvements"}),(0,i.jsx)("div",{className:"mt-1 whitespace-pre-wrap",children:e.improvements})]}),e.notes?(0,i.jsxs)("div",{children:[(0,i.jsx)("div",{className:"text-xs uppercase tracking-wide text-white/70",children:"Notes"}),(0,i.jsx)("div",{className:"mt-1 whitespace-pre-wrap",children:e.notes})]}):null]})]},e._id)}),0===f.length?(0,i.jsx)("p",{className:"text-sm text-white/70",children:"No evaluations yet."}):null]})]}),(0,i.jsxs)(n.Zp,{children:[(0,i.jsx)("h2",{className:"text-lg font-semibold",children:"Contact info"}),(0,i.jsx)("p",{className:"mt-1 text-sm text-white/80",children:"Coaches require an active subscription to view contact details."}),"evaluator"===y?(0,i.jsx)("p",{className:"mt-4 text-sm text-white/70",children:"Evaluators do not have access to player contact info."}):(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)("div",{className:"mt-4 flex items-center gap-3",children:[(0,i.jsx)(n.$n,{type:"button",onClick:P,disabled:a,children:w?"Refresh contact info":"View contact info"}),"coach"===y?(0,i.jsx)(l(),{href:"/coach/billing",className:"text-sm text-indigo-300 hover:text-indigo-200 hover:underline",children:"Manage billing"}):null,j?(0,i.jsx)("p",{className:"text-sm text-red-300",children:j}):null]}),w?(0,i.jsxs)("div",{className:"mt-4 text-sm text-white/90",children:[(0,i.jsxs)("div",{children:["Email: ",null!=(t=w.contactEmail)?t:"Not provided"]}),(0,i.jsxs)("div",{className:"mt-1",children:["Phone: ",null!=(s=w.contactPhone)?s:"Not provided"]})]}):(null==j?void 0:j.toLowerCase().includes("subscription required"))?(0,i.jsxs)("div",{className:"mt-4 rounded-2xl border border-white/10 bg-white/5 p-4",children:[(0,i.jsx)("div",{className:"text-sm font-semibold text-white/90",children:"Locked"}),(0,i.jsx)("p",{className:"mt-1 text-sm text-white/80",children:"Upgrade to view this player’s contact email and phone."}),(0,i.jsx)("div",{className:"mt-3",children:(0,i.jsx)(l(),{href:"/coach/billing",className:"inline-flex items-center justify-center rounded-md bg-indigo-600 px-4 py-2 text-sm font-medium text-white hover:bg-indigo-500",children:"Upgrade"})})]}):(0,i.jsxs)("div",{className:"mt-4 rounded-2xl border border-white/10 bg-white/5 p-4",children:[(0,i.jsx)("div",{className:"text-sm font-semibold text-white/90",children:"Not loaded"}),(0,i.jsx)("p",{className:"mt-1 text-sm text-white/70",children:"Click “View contact info” to load contact details."})]})]})]})]})}}},e=>{e.O(0,[664,587,18,358],()=>e(e.s=6305)),_N_E=e.O()}]);